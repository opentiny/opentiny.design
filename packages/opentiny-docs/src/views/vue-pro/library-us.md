<h1 id='makecell'>Cloud service client library</h1>

---

The cloud service client library provides a powerful library, which shields complex cloud service interconnection and lowers the threshold for front-end and back-end interconnection. The library is supported by HUAWEI CLOUD，it is also recommended that the new backend created by [Cloud Service Plug-in] (./plugin) be used together with the existing backend resources.

The cloud service client library supports different frameworks and technology stacks, including but not limited to React, Angular, and Vue.

<h2 id='makeinterface'>Cloud service interface</h2>

- [OBS](/vue-pro/docs/advanced/library#obsClient)

- [APIG](/vue-pro/docs/advanced/library#apigClient)

<h3 id='makeword'>Preparations</h3>

<h3 id='setcloud'>1. Registering a Huawei ID and Enabling HUAWEI CLOUD</h3>

请参考<a href="https://support.huaweicloud.com/usermanual-account/account_id_001.html" target="_blank">Registering a Huawei ID and Enabling HUAWEI CLOUD</a>。

<h3 id='setname'>2. Log in to HUAWEI CLOUD and complete real-name authentication</h3>

请参考<a href="https://support.huaweicloud.com/usermanual-account/account_id_004.html" target="_blank">Log in to HUAWEI CLOUD</a>。

请参考<a href="https://support.huaweicloud.com/usermanual-account/account_auth_00001.html" target="_blank">Real-name authentication</a>。


<h3 id='setplugin'>3. Installing and Configuring Cloud Service Plug-ins</h3>


Cloud service plug-ins can be used to create HUAWEI CLOUD services in your applications. You need to install and configure [`cloud service plug-ins`] first(/vue-pro/docs/advanced/plugin)。

<h3 id='intsall'>Install</h3>

To install the cloud service client library, open the console window and run the following command.

```bash
npm install @opentiny/hwc-client
```

<h3 id='object'>HwcClient Object</h3>

<h3 id='properties'>Property</h3>

| Attribute Name                                    | Type         | Description                |
| ----------------------------------------- | ------------ | ------------------- |
| config                                    | HwcConfigure | Collect user-configured objects  |
| [obsClient](/vue-pro/docs/advanced/library#obsClient)   | ObsClient    | OBS Object storage client |
| [apigClient](/vue-pro/docs/advanced/library#apigClient) | ApigClient   | APIG API Gateway Client |


<h3 id='methods'>Method</h3>

| Method Name                                        | Type                             | Description                |
| --------------------------------------------- | -------------------------------- | ------------------- |
| [configure](/vue-pro/docs/advanced/library#HwcClient) | (config：HwcConfigure ) => void; | Configuring the `HwcClient` Object |


<h3 id='HwcClient'>1. Configure the HwcClient object</h3>

In the frontend project, find the project entry file, usually in `main.js`, import the dependency package, and invoke the `configure` method.

```typescript
import { HwcClient } from '@opentiny/hwc-client';
import config from './hwc-exports.json'; // This file is generated by the cloud service plug-in and needs to be imported here

HwcClient.configure({
  ...config.hwcConfig,
});
```

<h3 id='obsClient'>2. obsClient</h3>

OBS Object storage client, which integrates the following functions<a href="https://www.npmjs.com/package/esdk-obs-browserjs" target="_blank" rel="noopener noreferrer">esdk-obs-browserjs</a> SDK，therefore, all APIs of the SDK are inherited，<a href="https://support.huaweicloud.com/sdk-browserjs-devg-obs/obs_24_0113.html" target="_blank" rel="noopener noreferrer">click here</a>This API is used to query the general SDK example

<h4>Sample code</h4>

```typescript
/**
 *
 * obs upload interface
 */

obsClient.putObject(
  {
    Bucket: 'bucketname',
    Key: 'objectname',
    Body: 'Hello OBS',
  },
  function (err, result) {
    // If the exception information is not empty, the interface invoking is abnormal
    if (err) {
      console.log('Error-->' + err);
    } else {
      //If the exception information is empty, the interface invoking is complete. You need to check the HTTP status code
      if (result.CommonMsg.Status < 300) {
        // Operation succeeded
        if (result.InterfaceResult) {
          // Service logic after successful processing
        }
      } else {
        // Operation failed, Obtain detailed exception information
        console.log('Code-->' + result.CommonMsg.Code);
        console.log('Message-->' + result.CommonMsg.Message);
        console.log('HostId-->' + result.CommonMsg.HostId);
        console.log('RequestId-->' + result.CommonMsg.RequestId);
      }
    }
  }
);
```


<h3 id='apigClient'>3. apigClient</h3>
API Gateway client, which provides the `exec` method to invoke HUAWEI CLOUD API Gateway instances. For details about how to create HUAWEI CLOUD API Gateway instances, see [`Cloud Service Plug-in`](/vue-pro/docs/advanced/plugin)。

```typescript
/**
 *
 * @param groupName Group Name
 * @param name Gateway Instance Name
 * @param data API Gateway instance parameters
 * @returns
 */
exec(groupName: string, name: string, data: ApigRequest) Promise<Response> {}
```

```typescript
interface ApigRequest {
  headers?: Record<string, string>;
  body?: any;
  query?: Record<string, string>;
  pathParams?: Record<string, string>;
}
```

<h4>Sample code</h4>

```typescript
const res = await HwcClient.apigClient.exec('DEFAULT', 'apig_001', {
  query: { name: 'user001' },
  body: JSON.stringify({ name: 'user001', desc: 'desc001' }),
});

const result = await res.json();
console.log('Request response result：', result);
```

> If the front end directly accesses the HUAWEI CLOUD gateway interface, cross-domain problems may occur. For details, see[HUAWEI CLOUD Documentation](https://support.huaweicloud.com/usermanual-apig/apig_03_0011.html)，add a cross-domain OPTIONS gateway to the gateway group.

